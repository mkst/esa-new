#include "common.h"

__asm__(
  ".comm D_800E4B9C,4\r\n" \
  ".comm D_800E4BA0,4\r\n" \
  ".comm D_800E524C,4\r\n" \
  ".comm D_800E5250,2\r\n" \
  ".comm D_800E5252,2\r\n" \
  ".comm D_800E5256,2\r\n" \
  ".comm D_800E5258,2\r\n" \
  ".comm D_800E525C,1\r\n" \
  ".comm D_800E5260,2\r\n" \
  ".comm D_800E5264,2\r\n" \
  ".comm D_800E526C,2\r\n" \
  ".comm D_800E5270,2\r\n" \
  ".comm D_800E5274,4\r\n" \
  ".comm D_800E5278,1\r\n" \
  ".comm D_800E527C,4\r\n" \
  ".comm D_800E5284,4\r\n" \
  ".comm D_800E5288,2\r\n" \
  ".comm D_800E528C,2\r\n" \
  ".comm D_800E5294,2\r\n" \
  ".comm D_800E5298,4\r\n" \
  ".comm D_800E529C,4\r\n" \
  ".comm gCurrentAnimalIndex,2 \r\n" \
  ".comm D_800E52A8,4\r\n" \
  ".comm D_800E52AC,2\r\n" \
  ".comm D_800E52B0,1\r\n" \
  ".comm D_800E52B4,2\r\n" \
  ".comm D_800E52C0,2\r\n" \
  ".comm D_800E52C4,1\r\n" \
  ".comm D_800E52CC,1\r\n" \
  ".comm D_800E52D0,2\r\n" \
  ".comm D_800E52D4,2\r\n" \
  ".comm D_800E52D8,2\r\n" \
  ".comm D_800E52DC,2\r\n" \
  ".comm D_800E52E0,1\r\n" \
);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80039D34);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80039D58);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80039E0C);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80039EC4);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80039F78);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003A4A0);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003A4C4);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003A4F8);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003A52C);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003A554);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003A578);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003A5D0);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003A620);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003A678);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003A69C);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003A6D0);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003A704);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003A738);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003A764);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003ABDC);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003AC14);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003AC5C);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003AC90);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003ACC0);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003ACE8);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003AD14);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003AD38);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003AD94);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003ADF4);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003AE30);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003AE54);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003AE78);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003AEBC);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003AEF0);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003AF20);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003B02C);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003B05C);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003B08C);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003B0FC);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003BD40);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003BF7C);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003D794);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003E300);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003E3D0);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003E5CC);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003E5EC);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003E734);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003E9A0);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003EBC8);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003F628);

#if 0

struct005 *D_800E5274;
struct004 *D_800E527C;

void func_8003F83C(u16 arg0, s32 *arg1, s32 *arg2) {
    s16 temp_4_2;
    s16 temp_22;
    s16 var_6;
    struct004 *temp_11;
    s32 temp_12;
    s32 xVel;
    s32 zVel;
    s32 temp_2_2;
    s32 temp_5_3;
    struct004 *temp_5_4;
    s32 temp_6;
    s32 temp_7;
    s32 temp_9;
    s32 temp_lo;
    s32 temp_lo_2;
    s32 temp_lo_3;
    s32 temp_lo_4;
    s32 temp_lo_5;
    s32 var_16;
    s32 xVelDelta;
    s32 zVelDelta;
    s32 var_3;
    s32 var_7;
    struct004 *temp_2;
    struct005 *temp_5_2;
    u16 temp_3;
    u16 temp_3_2;
    u16 temp_4;
    u16 temp_4_3;
    u8 var_4;
    struct006 *temp_5;

    xVel = D_800E527C->xVel;
    zVel = D_800E527C->zVel;

    if (D_800E527C->unk161 == 1) {
        temp_11 = D_800E527C->unk68;
        if (temp_11 != NULL) {
            temp_5 = temp_11->unk16C;
            if ((temp_5->unk2 == 5) && (temp_5->unkDA >= D_800E527C->unk16C->unkDA)) {
                temp_4 = (u16) D_800E5274->unk322;
                D_800E5274->unk324 = temp_4;
                var_6 = temp_11->unk322 - temp_11->unk324;
                D_800E5274->unk322 = (var_6 + temp_4) & 0xFF;
                D_800E527C->unk2C = (u16) ((var_6 + D_800E527C->unk2C) & 0xFF);
                if (var_6 != 0) {
                    temp_7 = (D_800E527C->xPos.w - temp_11->xPos.w) >> 8;
                    temp_5_3 = (D_800E527C->zPos.w - temp_11->zPos.w) >> 8;
                    temp_lo = temp_7 * (((s16)(D_800CA604[(var_6 + 0x40) & 0xFF])) >> 7);
                    var_7 = temp_7 * (((s16)(D_800CA604[var_6 & 0xFF])) >> 7);
                    D_800E527C->xPos.w = temp_11->xPos.w + temp_lo + (temp_5_3 * ((var_6 << 0x10) >> 0x17));
                    D_800E527C->zPos.w = (temp_11->zPos.w + (temp_5_3 * (((s16)(D_800CA604[(var_6 + 0x40) & 0xFF])) >> 7))) - var_7;
                }
            }
            temp_5_4 = D_800E527C->unk68;
            if (temp_5_4->unk16C->unk0 == 2) {
                xVelDelta = (*arg1 + (temp_5_4->xVel * 2)) - xVel;
                zVelDelta = (*arg2 + (temp_5_4->zVel * 2)) - zVel;
            } else {
                xVelDelta = (*arg1 + temp_5_4->xVel) - xVel;
                zVelDelta = (*arg2 + temp_5_4->zVel) - zVel;
            }
        }
    } else {
        xVelDelta = *arg1 - xVel;
        zVelDelta = *arg2 - zVel;
    }
    if (D_800E527C->unk161 == 1) {
        var_16 = arg0 * 0x3C;
    } else {
        if (D_800E527C->unk160 == 2) {
            var_4 = D_800E53A4[D_800E527C->xPos.h[1] >> 6][D_800E527C->zPos.h[1] >> 6].unk3;
        } else {
            var_4 = D_800E53A4[D_800E527C->xPos.h[1] >> 6][D_800E527C->zPos.h[1] >> 6].unk2;
        }
        var_16 = arg0 * D_800E53B4[var_4].unk0;
    }
    if ((D_800E529C->unk90 == POLAR_TANK) || (D_800E529C->unk90 == TORTOISE_TANK)) {
        if (var_16 == 0) {
            var_16 = 90;
        } else if (var_16 < 450) {
            var_16 = 450;
        }
    }
    temp_6 = func_80040304(xVelDelta, zVelDelta) >> 8;
    if ((temp_6 == 0) || (temp_6 < var_16)) {
        *arg1 = xVel + xVelDelta;
        *arg2 = zVel + zVelDelta;
        return;
    }

    if (temp_6 < (var_16 * 5)) {
        temp_lo_2 = ((xVelDelta >> 8) * var_16) / temp_6;
        temp_lo_3 = ((zVelDelta >> 8) * var_16) / temp_6;
        *arg1 = xVel + (temp_lo_2 << 8);
        *arg2 = zVel + (temp_lo_3 << 8);
        if (((xVel * temp_lo_2) > 0) || ((zVel * temp_lo_3) > 0)) {
            temp_3 = D_800E5274->unk322;
            func_800A32EC(
                xVel - ((D_800CA604[temp_3 & 0xFF] >> 7) << 0xA),
                zVel - ((D_800CA604[(temp_3 + 0x40) & 0xFF] >> 7) << 0xA)
            );
        } else {
            func_800A32EC(0, 0);
        }
    } else {
        temp_lo_4 = (s32) ((xVelDelta >> 8) * var_16) / temp_6;
        if (temp_6 == 0) {

        }
        temp_lo_5 = (s32) ((zVelDelta >> 8) * var_16) / temp_6;
        if (temp_6 == 0) {

        }
        *arg1 = xVel + (temp_lo_4 << 8);
        *arg2 = zVel + (temp_lo_5 << 8);
        if (((xVel * temp_lo_4) > 0) || ((zVel * temp_lo_5) > 0)) {
            temp_3_2 = (u16) D_800E5274->unk322;
            func_800A3404(
                xVel - (((D_800CA604[temp_3_2 & 0xFF]) >> 7) << 0xA),
                zVel - (((D_800CA604[(temp_3_2 + 0x40) & 0xFF]) >> 7) << 0xA)
            );
        } else {
            func_800A3404(0, 0);
        }
    }
}
#else
INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003F83C);
#endif

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003FDC4);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8003FFE4);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_800400F8);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80040260);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80040304);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80040350);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_800403E4);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80040A78);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80040E04);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80041018);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80041488);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80041880);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80041A9C);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80041CB8);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80041FEC);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80042204);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80042474);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_800428D0);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_800431C4);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_800433F0);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80043E8C);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8004436C);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_800444D8);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80044628);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8004473C);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8004484C);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_800449A4);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80044C2C);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80044EE4);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80045160);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80045270);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_800453A0);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8004596C);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_800459A0);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80045CA4);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80045E24);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80045FA4);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_800460A4);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_800463C4);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_800464F4);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80046628);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_800466EC);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80046850);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8004688C);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_800468E0);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80046900);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_8004693C);

INCLUDE_ASM("asm/esa/nonmatchings/2A334", func_80046C94);

s16 gCurrentAnimalIndex; // bss

void func_80046EC8(struct000 *arg0, struct000 *arg1, s16 *arg2) {
    s16 orig = *arg2;
    s16 tmp;

    switch (arg0->unk16C->unkDA) {
    case 0:
        *arg2 = *arg2 * 36 >> 4;
        break;
    case 1:
        *arg2 = *arg2 * 24 >> 4;
        break;
    case 2:
        *arg2 = *arg2 * 16 >> 4;
        break;
    case 3:
        *arg2 = *arg2 * 8 >> 4;
        break;
    case 4:
        *arg2 = *arg2 * 5 >> 4;
        break;
    }

    if (arg0 != D_800E73A8.animals[gCurrentAnimalIndex].animal) {
        tmp = (arg0->unk16C->unkDA - arg1->unk16C->unkDA);
        switch (tmp) {
        case 2:
            *arg2 = *arg2 >> 1;
            break;
        case 3:
            *arg2 = *arg2 >> 2;
            break;
        case 4:
            *arg2 = *arg2 >> 3;
            break;
        case 5:
        case 6:
        case 7:
            *arg2 = 0;
            break;
        }
    }
    if (orig != 0) {
        *arg2 = MAX(*arg2, 1);
    }
}
